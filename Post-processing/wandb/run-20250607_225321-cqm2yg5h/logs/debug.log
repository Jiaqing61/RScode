2025-06-07 22:53:21,597 INFO    MainThread:26784 [wandb_setup.py:_flush():68] Current SDK version is 0.19.10
2025-06-07 22:53:21,598 INFO    MainThread:26784 [wandb_setup.py:_flush():68] Configure stats pid to 26784
2025-06-07 22:53:21,598 INFO    MainThread:26784 [wandb_setup.py:_flush():68] Loading settings from /Users/huangjiaqing/.config/wandb/settings
2025-06-07 22:53:21,598 INFO    MainThread:26784 [wandb_setup.py:_flush():68] Loading settings from /Users/huangjiaqing/Desktop/Recommender Systems/RScode/Post-processing/wandb/settings
2025-06-07 22:53:21,598 INFO    MainThread:26784 [wandb_setup.py:_flush():68] Loading settings from environment variables
2025-06-07 22:53:21,598 INFO    MainThread:26784 [wandb_init.py:setup_run_log_directory():724] Logging user logs to /Users/huangjiaqing/Desktop/Recommender Systems/RScode/Post-processing/wandb/run-20250607_225321-cqm2yg5h/logs/debug.log
2025-06-07 22:53:21,598 INFO    MainThread:26784 [wandb_init.py:setup_run_log_directory():725] Logging internal logs to /Users/huangjiaqing/Desktop/Recommender Systems/RScode/Post-processing/wandb/run-20250607_225321-cqm2yg5h/logs/debug-internal.log
2025-06-07 22:53:21,598 INFO    MainThread:26784 [wandb_init.py:init():852] calling init triggers
2025-06-07 22:53:21,598 INFO    MainThread:26784 [wandb_init.py:init():857] wandb.init called with sweep_config: {}
config: {'parameters': {'General': ['gpu_id', 'use_gpu', 'seed', 'reproducibility', 'state', 'data_path', 'checkpoint_dir', 'show_progress', 'config_file', 'save_dataset', 'dataset_save_path', 'save_dataloaders', 'dataloaders_save_path', 'log_wandb'], 'Training': ['epochs', 'train_batch_size', 'learner', 'learning_rate', 'train_neg_sample_args', 'eval_step', 'stopping_step', 'clip_grad_norm', 'weight_decay', 'loss_decimal_place'], 'Evaluation': ['eval_args', 'repeatable', 'metrics', 'topk', 'valid_metric', 'valid_metric_bigger', 'eval_batch_size', 'metric_decimal_place'], 'Dataset': ['field_separator', 'seq_separator', 'USER_ID_FIELD', 'ITEM_ID_FIELD', 'RATING_FIELD', 'TIME_FIELD', 'seq_len', 'LABEL_FIELD', 'threshold', 'NEG_PREFIX', 'ITEM_LIST_LENGTH_FIELD', 'LIST_SUFFIX', 'MAX_ITEM_LIST_LENGTH', 'POSITION_FIELD', 'HEAD_ENTITY_ID_FIELD', 'TAIL_ENTITY_ID_FIELD', 'RELATION_ID_FIELD', 'ENTITY_ID_FIELD', 'load_col', 'unload_col', 'unused_col', 'additional_feat_suffix', 'rm_dup_inter', 'val_interval', 'filter_inter_by_user_or_item', 'user_inter_num_interval', 'item_inter_num_interval', 'alias_of_user_id', 'alias_of_item_id', 'alias_of_entity_id', 'alias_of_relation_id', 'preload_weight', 'normalize_field', 'normalize_all', 'benchmark_filename']}, 'yaml_loader': <class 'yaml.loader.FullLoader'>, 'file_config_dict': {'gpu_id': '0', 'workers': 2, 'seed': 42, 'reproducibility': True, 'state': 'INFO', 'encoding': 'utf-8', 'show_progress': True, 'shuffle': True, 'data_path': 'datasets/', 'save_dataset': True, 'dataset_save_path': None, 'save_dataloaders': True, 'dataloaders_save_path': None, 'checkpoint_dir': '../checkpoint_saved/lastfm-360k/', 'output_path': '../outputs/results/lastfm-360k/', 'log_wandb': True, 'wandb_project': 'jiaqing61-tud', 'wandb_path': 'outputs/', 'wandb_run_id': None, 'wandb_run_name': None, 'date': None, 'timestamp': None, 'log_root': '../outputs/logs/', 'repeatable': True, 'eval_args': {'split': {'RS': [0.8, 0.1, 0.1]}, 'mode': 'full', 'order': 'RO', 'group_by': 'user'}, 'metrics': ['Recall', 'Precision', 'NDCG', 'Hit', 'ItemCoverage', 'AveragePopularity', 'GiniIndex', 'ShannonEntropy', 'TailPercentage'], 'topk': 10, 'valid_metric': 'NDCG@10', 'valid_metric_bigger': True, 'eval_batch_size': 4096, 'metric_decimal_place': 4, 'skip_test': False, 'tail_ratio': 0.2, 'dataset': 'lastfm-360k', 'field_separator': '\t', 'seq_separator': ' ', 'USER_ID_FIELD': 'user_id', 'ITEM_ID_FIELD': 'artist_id', 'RATING_FIELD': 'plays', 'threshold': {'plays': 3}, 'load_col': {'inter': ['user_id', 'artist_id', 'plays']}, 'model': 'BPR', 'learner': 'adam', 'eval_step': 1, 'stopping_step': 5, 'epochs': 100, 'train_neg_sample_args': {'distribution': 'uniform', 'sample_num': 1, 'alpha': 1.0, 'dynamic': False, 'candidate_num': 0}, 'embedding_size': 64, 'learning_rate': 0.001, 'train_batch_size': 1024, 'reg_weight': 0.0003}, 'variable_config_dict': {}, 'cmd_config_dict': {}, 'external_config_dict': {'gpu_id': '0', 'workers': 2, 'seed': 42, 'reproducibility': True, 'state': 'INFO', 'encoding': 'utf-8', 'show_progress': True, 'shuffle': True, 'data_path': 'datasets/', 'save_dataset': True, 'dataset_save_path': None, 'save_dataloaders': True, 'dataloaders_save_path': None, 'checkpoint_dir': '../checkpoint_saved/lastfm-360k/', 'output_path': '../outputs/results/lastfm-360k/', 'log_wandb': True, 'wandb_project': 'jiaqing61-tud', 'wandb_path': 'outputs/', 'wandb_run_id': None, 'wandb_run_name': None, 'date': None, 'timestamp': None, 'log_root': '../outputs/logs/', 'repeatable': True, 'eval_args': {'split': {'RS': [0.8, 0.1, 0.1]}, 'mode': 'full', 'order': 'RO', 'group_by': 'user'}, 'metrics': ['Recall', 'Precision', 'NDCG', 'Hit', 'ItemCoverage', 'AveragePopularity', 'GiniIndex', 'ShannonEntropy', 'TailPercentage'], 'topk': 10, 'valid_metric': 'NDCG@10', 'valid_metric_bigger': True, 'eval_batch_size': 4096, 'metric_decimal_place': 4, 'skip_test': False, 'tail_ratio': 0.2, 'dataset': 'lastfm-360k', 'field_separator': '\t', 'seq_separator': ' ', 'USER_ID_FIELD': 'user_id', 'ITEM_ID_FIELD': 'artist_id', 'RATING_FIELD': 'plays', 'threshold': {'plays': 3}, 'load_col': {'inter': ['user_id', 'artist_id', 'plays']}, 'model': 'BPR', 'learner': 'adam', 'eval_step': 1, 'stopping_step': 5, 'epochs': 100, 'train_neg_sample_args': {'distribution': 'uniform', 'sample_num': 1, 'alpha': 1.0, 'dynamic': False, 'candidate_num': 0}, 'embedding_size': 64, 'learning_rate': 0.001, 'train_batch_size': 1024, 'reg_weight': 0.0003}, 'model': 'BPR', 'model_class': <class 'recbole.model.general_recommender.bpr.BPR'>, 'dataset': 'lastfm-360k', 'internal_config_dict': {'gpu_id': '0', 'worker': 0, 'use_gpu': True, 'seed': 2020, 'state': 'INFO', 'reproducibility': True, 'data_path': 'dataset/', 'checkpoint_dir': 'saved', 'show_progress': True, 'save_dataset': False, 'dataset_save_path': None, 'save_dataloaders': False, 'dataloaders_save_path': None, 'log_wandb': False, 'wandb_project': 'recbole', 'shuffle': True, 'epochs': 300, 'train_batch_size': 2048, 'learner': 'adam', 'learning_rate': 0.001, 'train_neg_sample_args': {'distribution': 'uniform', 'sample_num': 1, 'alpha': 1.0, 'dynamic': False, 'candidate_num': 0}, 'eval_step': 1, 'stopping_step': 10, 'clip_grad_norm': None, 'weight_decay': 0.0, 'loss_decimal_place': 4, 'require_pow': False, 'enable_amp': False, 'enable_scaler': False, 'transform': None, 'eval_args': {'split': {'RS': [0.8, 0.1, 0.1]}, 'group_by': 'user', 'order': 'RO', 'mode': 'full'}, 'repeatable': False, 'metrics': ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision'], 'topk': [10], 'valid_metric': 'MRR@10', 'valid_metric_bigger': True, 'eval_batch_size': 4096, 'metric_decimal_place': 4, 'embedding_size': 64, 'field_separator': '\t', 'seq_separator': ' ', 'USER_ID_FIELD': 'user_id', 'ITEM_ID_FIELD': 'item_id', 'RATING_FIELD': 'rating', 'TIME_FIELD': 'timestamp', 'seq_len': None, 'LABEL_FIELD': 'label', 'threshold': None, 'NEG_PREFIX': 'neg_', 'numerical_features': [], 'load_col': {'inter': ['user_id', 'item_id']}, 'unload_col': None, 'unused_col': None, 'additional_feat_suffix': None, 'rm_dup_inter': None, 'val_interval': None, 'filter_inter_by_user_or_item': True, 'user_inter_num_interval': '[0,inf)', 'item_inter_num_interval': '[0,inf)', 'alias_of_user_id': None, 'alias_of_item_id': None, 'alias_of_entity_id': None, 'alias_of_relation_id': None, 'preload_weight': None, 'normalize_field': None, 'normalize_all': None, 'discretization': None, 'ITEM_LIST_LENGTH_FIELD': 'item_length', 'LIST_SUFFIX': '_list', 'MAX_ITEM_LIST_LENGTH': 50, 'POSITION_FIELD': 'position_id', 'HEAD_ENTITY_ID_FIELD': 'head_id', 'TAIL_ENTITY_ID_FIELD': 'tail_id', 'RELATION_ID_FIELD': 'relation_id', 'ENTITY_ID_FIELD': 'entity_id', 'kg_reverse_r': False, 'entity_kg_num_interval': '[0,inf)', 'relation_kg_num_interval': '[0,inf)', 'benchmark_filename': None, 'MODEL_TYPE': <ModelType.GENERAL: 1>}, 'final_config_dict': {'gpu_id': '0', 'worker': 0, 'use_gpu': True, 'seed': 42, 'state': 'INFO', 'reproducibility': True, 'data_path': 'datasets/lastfm-360k', 'checkpoint_dir': '../checkpoint_saved/lastfm-360k/', 'show_progress': True, 'save_dataset': True, 'dataset_save_path': None, 'save_dataloaders': True, 'dataloaders_save_path': None, 'log_wandb': True, 'wandb_project': 'jiaqing61-tud', 'shuffle': True, 'epochs': 100, 'train_batch_size': 1024, 'learner': 'adam', 'learning_rate': 0.001, 'train_neg_sample_args': {'distribution': 'uniform', 'sample_num': 1, 'alpha': 1.0, 'dynamic': False, 'candidate_num': 0}, 'eval_step': 1, 'stopping_step': 5, 'clip_grad_norm': None, 'weight_decay': 0.0, 'loss_decimal_place': 4, 'require_pow': False, 'enable_amp': False, 'enable_scaler': False, 'transform': None, 'eval_args': {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}, 'repeatable': True, 'metrics': ['Recall', 'Precision', 'NDCG', 'Hit', 'ItemCoverage', 'AveragePopularity', 'GiniIndex', 'ShannonEntropy', 'TailPercentage'], 'topk': [10], 'valid_metric': 'NDCG@10', 'valid_metric_bigger': True, 'eval_batch_size': 4096, 'metric_decimal_place': 4, 'embedding_size': 64, 'field_separator': '\t', 'seq_separator': ' ', 'USER_ID_FIELD': 'user_id', 'ITEM_ID_FIELD': 'artist_id', 'RATING_FIELD': 'plays', 'TIME_FIELD': 'timestamp', 'seq_len': None, 'LABEL_FIELD': 'label', 'threshold': {'plays': 3}, 'NEG_PREFIX': 'neg_', 'numerical_features': [], 'load_col': {'inter': ['user_id', 'artist_id', 'plays']}, 'unload_col': None, 'unused_col': None, 'additional_feat_suffix': None, 'rm_dup_inter': None, 'val_interval': None, 'filter_inter_by_user_or_item': True, 'user_inter_num_interval': '[0,inf)', 'item_inter_num_interval': '[0,inf)', 'alias_of_user_id': None, 'alias_of_item_id': None, 'alias_of_entity_id': None, 'alias_of_relation_id': None, 'preload_weight': None, 'normalize_field': None, 'normalize_all': None, 'discretization': None, 'ITEM_LIST_LENGTH_FIELD': 'item_length', 'LIST_SUFFIX': '_list', 'MAX_ITEM_LIST_LENGTH': 50, 'POSITION_FIELD': 'position_id', 'HEAD_ENTITY_ID_FIELD': 'head_id', 'TAIL_ENTITY_ID_FIELD': 'tail_id', 'RELATION_ID_FIELD': 'relation_id', 'ENTITY_ID_FIELD': 'entity_id', 'kg_reverse_r': False, 'entity_kg_num_interval': '[0,inf)', 'relation_kg_num_interval': '[0,inf)', 'benchmark_filename': None, 'MODEL_TYPE': <ModelType.GENERAL: 1>, 'workers': 2, 'encoding': 'utf-8', 'output_path': '../outputs/results/lastfm-360k/', 'wandb_path': 'outputs/', 'wandb_run_id': None, 'wandb_run_name': None, 'date': None, 'timestamp': None, 'log_root': '../outputs/logs/', 'skip_test': False, 'tail_ratio': 0.2, 'dataset': 'lastfm-360k', 'model': 'BPR', 'reg_weight': 0.0003, 'MODEL_INPUT_TYPE': <InputType.PAIRWISE: 2>, 'eval_type': <EvaluatorType.RANKING: 1>, 'single_spec': True, 'local_rank': 0, 'device': device(type='cpu'), 'valid_neg_sample_args': {'distribution': 'uniform', 'sample_num': 'none'}, 'test_neg_sample_args': {'distribution': 'uniform', 'sample_num': 'none'}}, '_wandb': {}}
2025-06-07 22:53:21,598 INFO    MainThread:26784 [wandb_init.py:init():893] starting backend
2025-06-07 22:53:21,598 INFO    MainThread:26784 [wandb_init.py:init():897] sending inform_init request
2025-06-07 22:53:21,669 INFO    MainThread:26784 [backend.py:_multiprocessing_setup():101] multiprocessing start_methods=spawn,fork,forkserver, using: spawn
2025-06-07 22:53:21,669 INFO    MainThread:26784 [wandb_init.py:init():907] backend started and connected
2025-06-07 22:53:21,674 INFO    MainThread:26784 [wandb_init.py:init():1002] updated telemetry
2025-06-07 22:53:21,675 INFO    MainThread:26784 [wandb_init.py:init():1026] communicating run to backend with 90.0 second timeout
2025-06-07 22:53:22,170 INFO    MainThread:26784 [wandb_init.py:init():1101] starting run threads in backend
2025-06-07 22:53:22,323 INFO    MainThread:26784 [wandb_run.py:_console_start():2566] atexit reg
2025-06-07 22:53:22,324 INFO    MainThread:26784 [wandb_run.py:_redirect():2414] redirect: wrap_raw
2025-06-07 22:53:22,324 INFO    MainThread:26784 [wandb_run.py:_redirect():2483] Wrapping output streams.
2025-06-07 22:53:22,324 INFO    MainThread:26784 [wandb_run.py:_redirect():2506] Redirects installed.
2025-06-07 22:53:22,326 INFO    MainThread:26784 [wandb_init.py:init():1147] run started, returning control to user process
